## 네크워크

네트워크란 노드와 링크가 서로 연결되어 있거나 연결되어 있지 않은 집합체를 의미합니다.

노드 : 서버 라우터 스위치 등의 네크워크 장치를 의미

링크 : 유선 또는 무선을 의미

### 처리량과 지연 시간

#### 처리량 

링크를 통해 전달되는 단위 시간당 데이터양 단위는 bps입니다.

> 대역폭
>
> 주어진 시간동안 네트워크 연결을 통해 흐를 수 있는 최대 비트 수

#### 지연시간

요청이 처리되는 시간을 말하며 어떤 메시지가 두 장치 사이를 왕복하는데 걸린 시간을 말합니다.

매체타입, 패킷크기, 라우터의 패킷 처리 시간에 영향을 받습니다.

### 네트워크 토폴로지

노드와 링크가 어떻게 배치되어 있는지에 대한 방식이자 연결 형태를 의미합니다.

#### 트리 토폴로지

계층형 토폴로지라고 하며 트리형태로 배치

노드의 추가 삭제가 쉬우며 특정노드에 트래픽이 집중되면 하위 노드에 영향을 끼칠 수 있습니다.

#### 버스 토폴로지

버스 토폴로지는 중앙 통신 회선 하나에 여러개의 노드가 연결되어 공유하는 네트워크 구성을 말하며 근거리 통신망에서 사용합니다.

설치비용이 적고 신뢰성이 우수하며 중앙 통신 회선에 노드를 추가하거나 삭제하기 쉽습니다.

스푸핑이 가능한 문제점이 있습니다.

> 스푸핑
>
> LAN상에서 송신부의 패킷을 송신과 관련없는 다른 호스트에 가지 않도록 하는 스위칭 기능을 마비 시키거나 속여서 특정 노드에 해당 패킷이 오도록 처리하는 것을 말합니다.

#### 스타 토폴로지

중앙에 있는 노드에 모두 연결된 형태

노드를 추가하거나 에러를 탐지하기 쉽고 패킷의 충돌 발생 가능성이 적습니다. 장애노드가 중앙노드가 아닐경우 다른 노드에 영향을 끼치는것이 적습니다. 하지만 중앙 노드에 에러가 발생하면 전체 네트워크를 사용할 수 없고 설치 비용이 고가입니다.

#### 링형 토폴로지

각각의 노드가 양옆의 두 노드와 연결하여 전체적으로 고리처럼 하나의 연속된 길을 통해 통신하는 망 구성 방식입니다.

#### 메시 토폴로지

망형 토폴로지라고도 하며 그물말처럼 연결되어 있는 구조입니다.

하나의 장치가 고장이 나더라도 여러개의 경로가 존재하므로 네트워크를 계속 사용할 수 있고 트래픽도 분산 처리 가능합니다.

노드 추가가 어렵고 구축 비용과 운용 비용이 고가인 단점이 있습니다.

### 병목현상

토폴로지가 중요한 이유는 병목현상을 찾을때 중요한 기준이 되기 때문입니다.

병목현상이란

전체 시스템의 성능이나 용량이 하나의 구성 요소로 인해 제한 받는 현상을 말합니다.

## TCP / IP 4계층 모델

각 계층들은 특정 계층이 변경되었을때 다른 계층이 영향을 받지 않도록 설계되어 있습니다.

### 애플리케이션 계층

FTP, HTTP, SSH, SMTP DNS 등 응용프로그램이 사용되는 프로토콜 계층이며 웹 서비스, 이메일 등 서비스를 실질적으로 사람들에게 제공하는 층입니다.

> FTP
>
> 장치와 장치 간의 파일을 전송하는데 사용되는 표준 프로토콜
>
> SSH
>
> 보안되지 않느 네트워크에서 네트워크 서비스를 안정하게 운영하기 위한 암호화 네트워크 프로토콜
>
> HTTP
>
> WWW를 위한 데이터 통신의 기초이자 웹 사이트를 이용하는데 쓰는 프로토콜
>
> SMTP
>
> 전자 메일 전송을 위한 인터넷 표준 통신 프로토콜
>
> DNS
>
> 도메인 이름과 IP 주소를 매핑해주는 서버

###  전송 계층

송신자와 수신자를 연결하는 통신 서비스를 제공하며 연결지향 데이터 스트림 지원, 신뢰성, 흐름 제어를 제공하며 애플리케이셔노가 인터넷 계층 사이의 데이터가 전달될 때의 중계역할을 합니다.

#### TCP

패킷 사이의 순서를 보장하고 연결지향 프로토콜을 사용해서 연결을 하여 신뢰성을 구축해서 수신여부를 확인하며 `가상회선 패킷 교환방식`을 사용합니다.

> 가상회선 패킷교환 방식
>
> 각 패킷에는 가상회선 식별자가 포함되며 패킷들은 전송된 순서대로 도착하는 방식을 말합니다.

연결할때는 `3-way-handshake`작업을 진행합니다.

3-way-handshake

1. 클라이언트가 클라이언트의 ISN을 담아 SYN을 보냅니다.
2. 서버가 서버의 ISN을 담아 SYN 그리고 클라이언트의 ISN+1을 담아 ACK를 보냅니다.
3. 클라이언트가 서버의 ISN+1을 담아 ACK를 보냅니다.

연결을 끊을때는 `4-way-handshake`작업을 진행합니다.

1. 클라이언트가 서버에 FIN을 보냅니다. 

   클라이언트 : FIN_WAIT1

2. 서버는 ACK를 클라이언트에 보냅니다.

   클라이언트 : FIN_WAIT2

   서버: CLOSE_WAIT

3. 서버는 클라이언트에 FIN을 보냅니다.

   클라이언트 : TIME_WAIT

   서버: LAST_ACK

4. 클라이언트가 서버에 ACK를 보냅니다. 

   클라이언트 :  TIME_WAIT -> CLOSED

   서버: CLOSED

연결을 바로 끊지 않고 TIME-WAIT을 하는 이유는

첫번째로 지연패킷이 발생할 경우를 대비한것이고

두번째로는 두 장치가 연결이 닫혔는지 확인하기 위해서 입니다. 제대로 닫혀야 다시 연결할때 오류가 안생깁니다.

#### UDP

순서를 보장하지 않고 수신여부를 확인하지 않으며 단순히 데이터만 주는 `데이터그램 패킷교환 방식`을 사용합니다.

> 데이터그램 패킷교환 방식
>
> 패킷이 독립적으로 이동하며 최적의 경로를 선택하며 가는데 도착한 순서가 다를수 있습니다

### 인터넷 계층

장치로부터 받은 네트워크 패킷을 IP 주소로 지정된 목적지로 전송하기 위해 사용되는 계층입니다. 

IP, ARP, ICMP등이 있으며 패킷을 수신해야할 상대의 주소를 지정하여 데이터를 전달합니다. 

상대방이 제대로 받았는지에 대해 보장하지 않는 비연결형입니다.

### 링크 계층

전선, 광섬유, 무선 등으로 실질적으로 데이터를 전달하며 장치간의 신호를 주고받는 `규칙`을 정하는 계층입니다.

물리계층과 데이터링크 계층으로 나누기도 하는데

물리 계층은 무선LAN과 유선 LAN을 통해 0과 1로 이루어진 데이터를 보내는 계층을 말하며

데이터 링크 계층은 이더넷 프레임을 통해 에러확인, 접근 제어를 담당하는 계층을 말합니다.

#### 유선 LAN

전이중화 통신을 씁니다. -> 양쪽장치에서 동시에 송수신하는 방식을 말합니다.

#### 무선 LAN

 반이중화 통신을 씁니다. -> 한번에 한 방향만 통신할 수 있는 방식을 말합니다.

## 계층 간 데이터 송수신 과정

예를 들어 HTTP를 통해 웹 서버에 있는 데이터를 요청한다면?

애플리케이션 계층에서 전송 계층으로 필자가 보내는 요청값들이 캡슐화 과정을 거쳐 전달되고 링크 계층을 통해 서버와 통신하고 다시 비캡슐화 과정을 거쳐 데이터가 전송됩니다.

### 캡슐화 과정

상위 계층의 헤더와 데이터를 하위 계층의 데이터 부분에 포함시키고 해당계층의 헤더를 삽입하는 과정을 말합니다.

애플리케이션 계층 : 데이터

전송계층 : TCP(L4)헤더 + 데이터

인터넷 계층 : IP(L3)헤더 + TCP(L4)헤더 + 데이터

링크 계층 : 프레임헤더 + IP(L3)헤더 + TCP(L4)헤더 + 데이터 + 프레임 트레일러

### PDU

계층 간 데이터가 전달될 대 한 덩어리의 단위를 PDU라고 합니다.

PDU는 제어관련 정보들이 포한됨 '헤더', 데이터를 의미하는 '페이로드'로 구성되어 있으며 계층마다 부르는 명칭이 다릅니다.

애플리케이션 : 메시지

전송계층 : 세스먼튼(TCP), 데이터그램(UDP)

인터넷 계층 : 패킷

링크계층 : 프레임(데이터링크), 비트(물리)

## 네트워크 기기

네트워크 기기는 계층별로 처리 범위를 나눌 수 있습니다.그리고 상위 계층을 처리하는 기기는 하위 계층을 처리할 수 있지만 그 반대는 불가합니다. 

L7 스위치는 그 밑의 모든 계층의 프로토콜을 처리할 수 있습니다. 

- 애플리케이션 계층 : L7 스위치
- 인터넷 계층 : 라우터 , L3 스위치
- 데이터 링크 계층 : L2스위치, 브리지
- 물리계층 : NIC, 리피터, AP

### L7 스위치

여러 장비를 연결하고 데이터 통신을 중재하며 목적지가 연결된 포트로만 전기 신호를 보내 데이터를 전송하는 통신 네트워크 장비 입니다.

로드 밸러서라고도 하며 서버의 부하를 분산하는 기기 입니다. 클라이언트로 부터 오는 요청들을 뒤 쪽의 여러 서버로 나누는 역할을 하며 시스템이 처리할 수 있는 트래픽 증가를 목표로 합니다.

URL, 서버, 캐시, 쿠키 들을 기반으로 트래픽을 분산합니다. 바이러스 불필요한 외부 데이터 등을 걸러내는 필터링 기능 또한 가지고 있으며 응용프로그램 수준의 트래픽 모니터링도 가능합니다.

### 라우터

라우터는 여러개의 네트워크를 연결, 분할, 구분시켜주는 역할을 하며 다른 네트워크에 존재하는 장치끼리 서로 데이터를 주고 받을때 패킷 소모를 최소화하고 경로를 최적화 하여 최소 경로로 패킷을 포워딩 하는 라우팅을 하는 장비입니다.

### L3 스위치

L2스위치의 기능과 라우팅 기능을 갖춘 장비를 말합니다. 라우터는 소프트웨어 기반 라우팅과 하드웨어 기반의 라우팅을 하는 것으로 나눠지고 하드웨어 기반의 라우팅을 담당하는 장치를 L3 스위치 라고 합니다.

### L2 스위치

MAC주소를 MAC 주소 테이블을 통해 관리하며 연결된 장치로 부터 패킷이 왔을때 패킷 전송을 담당합니다.

IP주소를 이해하지 못해 IP 주소를 기반으로 라우팅이 불가하며 단순히 패킷의 MAC주소를 읽어 스위칭하는 역할을 합니다.

### 브리지

두개의 근거리 통신망을 상호 접속할 수 있도록 하는 통신망 연결장치로 포트와 포트 사이의 다리 역할을 하며 장치에서 받아온 MAC 주소를 MAC 주소 테이블로 관리합니다.

### NIC

2대 이상의 컴퓨터 네트워크를 구성하는데 사용하며, 네트워크와 빠른 속도로 데이터를 송수신 할 수 있도록 컴퓨터 내에 설치하는 확장 카드 입니다.

### 리피터

들어오는 약해진 신호 정도를 증폭하여 다른쪽으로 전닳라는 장치를 말합니다.

## IP 주소

컴퓨터와 컴퓨터 간의 통신은 흔히들 IP 주소 기반으로 통신한다고 알고 있지만 정확히 이야기 하자면 IP 주소에서 ARP를 통해 MAC주소를 찾아 MAC주소를 기반으로 통신합니다.

### 홉바이홉 통신

통신망에서 각 패킷이 여러개의 라우터를 건너가는 모습을 비유적으로 표현한 것입니다. 각각의 라우터에 있는 라우팅 테이블의 IP를 기반으로 패킷을 전달하고 다시 전달해나갑니다.

> 라우팅이란 IP주소를 찾아가는 과정을 말합니다.
>
> 라우팅 테이블이란?
>
> 송신지에서 수신지 까지 도달하기 위해 사용되며 라우터에 들어가 있는 정보들과 그 목적지로 가기위한 방법이 들어 있는 리스트를 뜻합니다.
>
> 라우팅 테이블에는 게이트웨이와 모든 목적이에 대해 해당 목적지에 도달하기 위해 거쳐야할 다음 라우터의 정보를 가지고 있습니다.
>
> 게이트웨이
>
> 서로 다른 통신망, 프로토콜을 사용하는 네트워크 간의 통신을 가능하게 하는 관문 역할을 하는 컴퓨터나 소프트웨어를 두루 일컫는 용어입니다.

### 주소 체계

#### IPv4

32비틑를 8비트 단위로 점을 찍어 표기

#### IPv6

64비트를 16비트 단위로 점을 찍어 표기

## HTTP

앞서 말한 전송 계층 위에 있는 애플리케이션 계층으로 웹 서비스 통신에 사용됩니다.

### HTTPS

애플리케이션 계층과 전송 계층 사이에 신뢰계층인 SSL/TLS 계층을 넣은 신뢰 할 수 있는 HTTP 요청을 말합니다.

### SSL/TLS

전송계층에서 보안을 제공하는 프로토콜입니다. 클라이언트와 서버가 통신할때 제 3자가 메시지를 도청하거나 변조하지 못하도록합니다.

## 가고자하는 주소를 주소창에 입력하면 어떤식으로 동작할까요?

대기열, 캐싱, DNS, 라우팅, ARP, 초기연결을 거쳐 컨텐츠를 다운 받게 되고 이 후 브라우저렌더링 과정을 거쳐 네이버라는 화면이 나타나게 됩니다. 또한 이러한 과정이 비캡슐화, 캡슐화과정을 거쳐 이뤄지게 됩니다.

1. 대기열

   주소창요청을 대기열에 넣습니다.

2. 캐시

   공유 프록시 캐시와 브라우저 캐시로 나눠집니다.

   공유 프록시 캐시

   요청한 서버에서 프록시 서버가 캐싱하는 것을 의미합니다.

3. DNS

   브라우저가 요청의 IP 주소를 확인하는 단계입니다.

   IP주소를 바꾸어도 도메인 주소는 안바꿔도 된다.

4. 라우팅

   IP주소를 찾아가는 과정이며 라우팅 테이블, 서브네트워크를 거쳐 찾아갑니다. (홉바이홉통신)

   패킷을 전달하고 다시 전달해나가는 과정을 거칩니다.

5. ARP

   이렇게 찾은 IP를 바탕으로 ARP를 통해 물리적 주소인 MAC 주소를 찾게 됩니다.

6. 그 후 초기연결

7. 콘텐츠 다운로드

8. 브라우저 렌더링

   1. HTML, CSS가 파서에 의해 해석후 DOM트리 구축
   2. 렌더 트리와 렌드레이어 생성
   3. 렌더레이어를 대상으로 Layout 설정(위치잡기)
   4. 색칠하기 paint
   5. 레이어를 합쳐서 표기

#### 캡슐화

애플리케이션 -> 전송 -> 인터넷 -> 링크 계층을 통해 캡슐화 과정이 진행된다.

상위 계층의 헤더와 데이터를 하위 계층의 데이터에 포함시키고 하위 계층의 헤더를 추가하는 방식으로 작동

