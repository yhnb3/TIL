## 네트워크

노드와 링크가 서로 연결되어 있으며 리소스를 공유하는 집합을 의미합니다.

### 처리량(throughput)

링크 내의 흐르는 데이터의 양을 말하며 얼마만큼의 트래픽을 처리했는지를 나타냅니다.

단위: bps(bits per second)

처리량은 사용자들이 많이 접속할때마다 커지는 트래픽, 네트워크 장치 간의 대역폭, 네트워크 중간에 발생하는 에러, 장치의 하드웨어 스펙에 영향을 받습니다.

#### 트래픽

링크 내에 흐르는 데이터 양 서버에 저장된 파일을 클라이언트가 다운로드 시 발생하는 데이터의 누적량을 뜻합니다.

#### 대역폭

주어진 시간 동안 네트워크 연결을 통해 흐를 수 있는 최대 비트 수

**허용할 수 있는 동시접속자 수**

도로로 따지면 차선

#### 지연시간

요청이 처리되는 시간을 말하며 어떤 메시지가 두 장치 사이를 왕복하는데 걸린 시간

### 토폴로지

노드와 링크가 어떻게 배치되어 있는지에 대한 방식이자 연결 형태를 의미합니다.

- 트리 토폴로지

  계층형 토폴로지라고 하며 트리 형태로 배치한 네트워크 구성을 말합니다. 노드의 추가 삭제가 쉬우며 특정 노드에 트래픽이 집중될 때 하위 노드에 영향을 끼칠 수 있습니다.

- 버스 토폴로지

  버스 토폴로지는 중앙 통신 회선 하나에 여러개의 노드가 연결되어 공유하는 네트워크 구성을 말하며 근거리 통신망에 사용합니다. 설치비용이 적고 신뢰성이 우수하며 노드를 추가하거나 삭제하기 쉽습니다 . 그러나 수푸핑이 가능한 문제점이 있습니다.

  > 스푸핑
  >
  > LAN 상에서 송신부의 패킷을 송신과 관련없는 다른 호스트에 가지 않도록 하는 스위칭 기능을 마비시키거나 속여서 특정 노드에 해당 패킷이 오도록 처리하는 것을 말합니다.

- 스타 토폴로지

  중앙에 있는 노드를 기반으로 모두 연결된 네트워크 구성을 말합니다. 중앙 노드에 문제가 생기면 모든 노드에 문제가 생깁니다.

- 링형 토폴로지

  노드의 수가 증가되어도 네트워크 상의 손실이 거의 없고 충돌이 발생하는 가능성이 적고 노드의 고장 발견을 쉽게 찾을 수 있습니다. 회선의 장애가 발생되면 전체 네트워크에 영향을 끼칩니다.

- 메시 토폴로지

  망형 토폴로지라고도 하고 그물망의 구조를 가집니다.

  하나의 단말 장치에 장애가 생겨도 네트워크를 계속 사용할 수 있고 트래픽도 분산 처리가 가능합니다. 노드 추가가 어렵고 운용비용이 고가입니다.

#### 토폴로지가 중요한 이유

병목 현상을 찾을 때 중요한 기준이 되기 때문입니다. 

>병목현상
>
>전체 시스템의 성능이나 용량이 하나의 구성 요소로 인해 제한을 받는 현상을 말합니다. 서비스에서 이벤트를 열었을때 트래픽이 많이 생기고 그 트래픽을 잘 관리하지 못하면 병목 현상이 생겨 사용자는 웹사이트로 들어가지 못합니다.

서버의 성능을 향상 시키는 것이 아닌 회선을 추가함 으로써도 병목현상을 해결 할 수 있습니다.

#### 네트워크의 분류

LAN : 사무실과 개인적으로 소유가능한 규모

MAN : 서울시 등 정도의 규모

WAN : 세계 규모

## TCP / IP 4계층 모델과 OSI 7계층

인터넷 프로토콜 스위트( internet protocol suite)는 인터넷에서 컴퓨터들이 서로 정보를 주고받는데 쓰이는 프로토콜의 집합이며, 이름 TCP/IP 4계층 모델로 설명하거나 OSI 7계층 모델로 설명하기도 합니다.

TCP / IP 4계층      OSI 7계층

애플리케이션       애플리케이션

​                              프레젠테이션

​                               세션

전송                       전송

인터넷                   네트워크

링크                       데이터 링크

​                               물리 계층

### TCP / IP

- 애플리케이션 계층 : FTP, HTTP, SSH
- 전송 계층 : TCP, UDP
- 인터넷 계층 : IP
- 링크 계층 : 이더넷

이 계층들은 특정 계층이 변경 되었을때 다른 계층이 영향을 받지 않도록 설계되었습니다.

#### 애플리케이션 계층

FTP, HTTP, SSH, SMTP, DNS 등 응용 프로그램이 사용되는 프로코톨 계층 / 웹 서비스, 이메일 서비스를 실질적으로 사람들에게 제공하는 층입니다.

- FTP : 파일 전송
- HTTP : 웹서비스 통신의 기초
- SSH : 암호화 네트워크 프로토콜
- SMTP : 메일 프로토콜
- DNS : 도메인 이름과 IP주소를 매핑해주는 서버

#### 전송 계층

송신자와 수신자를 연결하는 통신 서비스를 제공하며 애플리케이션과 인터넷 계층 사이의 데이터가 전달될 때 중계 역할을 합니다. 대표적으로 TCP와 UDP가 있습니다.

연결지향 통신

신뢰성

흐름제어(송신 측과 수신 측의 데이터 처리 속도 차이를 해결하기 위한 기법) 

혼잡제어(네트워크 내에 패킷의 수가 과도하게 증가하는 현상을 방지)

#### 인터넷 계층

장치로 부터 받은 네트워크 패킷을 IP주소로 지정된 목적지로 전송하기 위해 사용되는 계층입니다. IP, ARP, ICMP등이 있으며 패킷을 수신해야할 상대의 주소를 지정하여 데이터를 전달합니다. 상대방이 제대로 받았는지에 대해 보장하지 않는 비연결형적인 특징을 가지고 있습니다.

#### 링크 계층

전선 광섬유, 무선 등으로 실질적으로 데이터를 전달하며 장치 간에 신호를 주고 받는 '규칙'을 정하는 계층입니다.

물리 계층과 데이터 링크 계층으로 나뉘어 지기고 하는데

물리계층은 무선 LAN과 유선 LAN을 통해 0과 1로 이루어진 데이터를 보내는 계층을 말하며

데이터 링크 계층은 '이더넷 프레임'을 통해 에러확인, 흐름제어, 접근제어를 담당하는 계층을 말합니다.

## TCP vs UDP

TCP는 패킷 사이의 순서를 보장하고 연결지향 프로토콜 ( 3-way-handshake)를 사용해서 연결을 하여 신뢰성을 구축해서 수신 여부를 확인하며 '가상회선 패킷 교환 방식'을 사용합니다.

UDP는 순서를 보장하지 않고 수신 여부를 확인하지 않으며 단순히 데이터만 주는 '데이터그램 패킷 교환 방식'을 사용합니다.

> 가상회선 패킷 교환 방식
>
> 각 패킷에는 가상회선 식별자가 포함되며 모든 패킷을 전송하면 가상회선이 해제되고 패킷들은 전송된 '순서대로' 도착하는 방식을 말합니다.
>
> 데이터 그램 패킷 교환 방식
>
> 패킷이 독립적으로 이동하며 최적의 경로를 선택하여 가는데, 하나의 메시지에서 분할된 여러 패킷은 서로 다른 경로롤 전송될 수 있으며 도착한 순서가 다를 수 있는 방식을 뜻합니다.

데이터를 전송하는데 발생하는 오류 3가지 (TCP는 모두 방지 및 제거 가능, UDP는 내부 손상만 방지 가능)

- 패킷의 잘못된 순서
- 패킷 손실
- 패킷 내부의 손상된 데이터(체크섬을 기반으로 체크)

> 체크섬
>
> 헤더, 패킷내요, IP  등을 기반으로 체크섬을 만들어 패킷 내부의 데이터 손상을 파악함.

#### 3 way handshake

SYN : synchronization 연결 요청 플래그

ACK : acknowledgement 응답 플래그

ISN : initial Sequence Numbers 초기 네트워크 연결을 할 때 할당된 32비트 고유 시퀀스 번호

1. 클라이언트는 서버에 클라이언트의 ISN을 SYN 에 담아 보낸다.
2. 서버는 SYN을 수신하고 SYN에 서버의 ISN을 담아 보내며 ACK에 클라이언트의 ISN +1을 담아 보낸다.
3. 클라이언트는 서버의 ISN을 받아 ACK에 ISN +1을 담아 서버로 보낸다.

#### 4 way handshake

TCP가 연결을 해제할때

1. 클라이언트가 서버에 FIN이라는 플래그를 보내고

   클라이언트 : FIN_WAIT_1 상태

2. 서버가 FIN을 수신하고 close wait상태가 되면서 ACK를 클라이언트에게 보낸다

   서버: CLOSE_WAIT 상태

   클라이언트 : FIN_WAIT_2 상태 

3. 서버가 LAST_ACK상태가 되면서 클라이언트에 FIN을 보낸다.

   서버 : LAST_ACK

4. 클라이언트가 FIN을 수신하면 TIME_WAIT 상태가 되고 서버에 ACK를 보내고 어느정도 시간을 대기한 후 연결이 닫히고 클라이언트와 서버의 모든 자원의 연결이 해제됩니다.

   서버 : CLOSED

   클라이언트 : TIME_WAIT => CLOSED

**클라이언트가 TIME_WAIT 상태를 가지는 이유?**

1. 지연 패킷이 발생할 경우를 대비하기 위함입니다. 패킷이 뒤늦게 도달하고 이를 처리하지 못한다면 데이터 무결성 문제가 발생합니다.

##  IP와 라우팅

IP 주소를 통해 통신하는 과정을 홉바이홉 통신이라고 합니다. 여기서 홉이란 영어 뜻 자체로는 건너뛰는 모습을 의미합니다. 이는 통신망에서 각 패킷이 여러개의 라우터를 건너가는 모습을 비유적으로 표현한 것입니다. 각각의 라우터에 있는 라우팅 테이블의IP를 기반으로 패킷을 전달하고 다시 전달해 나가서 최종 목적지에 다르는 것입니다.

#### 라우팅

IP주소를 찾아가는 과정

#### 라우팅 테이블

라우팅 테이블은 송신지에서 수신지 까지 도달하기 위해 사용되며 라우터에 들어가 있는 목적지 정보들과 그 목적지로 가기 위한 방법이 들어 있는 리스트를 뜻합니다. 라우팅 테이블에는 게이트웨이와 모든 목적지에 대한 해당 목적지에 도달하기 위해 거쳐야할 다음 라우터의 정보를 가지고 있습니다.

#### 게이트 웨이

서로 다른 통신망, 프로토콜을 사용하는 네트워크 간의 통신을 가능하게 하는 관문 역할을 하는 컴퓨터나 소프트웨어를 두루 일컫는 용어입니다.

사용자는 인터넷에 접속하기 위해 수많은 톨게이트인 게이트 웨이를 거쳐야하며 게이트 웨이는 서로 다른 네트워크상의 통신 프로토콜을 변환해주는 역할을 하기도 합니다.

###  IP와 ARP, RARP

IP주소에서 ARP를 통해 MAC주소를 찾아 MAC주소를 기반으로 통신합니다.

 ARP :  IP주소를 통해 MAC주소를 구하는 다리와 같은것.

RARP : MAC주소를 IP주소로 변환 하기도 합니다.

장치 A가 ARP Request 브로드캐스트를 보내며 IP 주소에 맞는 장치가 ARP reply 유니캐스트를 통해 MAC 주소를 반환하는 과정을 거쳐 IP 주소에 맞는 MAC 주소를 찾게 됩니다,.

브로드 캐스트 : 송신 호스트가 전송한 데이터가 네트워크에 연결된 모든 호스트에 전송되는 방식

유니캐스트 : 고유 주소로 식별된 하나의 네트워크 목적지에 1:1 로 데이터를 전송하는 방식

### 캡슐화 과정과 비캡슐화 과정

#### PDU (단위)

- 애플리케이션 계층 : 메시지
- 전송계층 : 세그먼트(TCP), 데이터 그램(UDP)
- 인터넷 계층  : 패킷
- 링크 계층 : 프레임(데이터 링크 계층), 비트(물리 계층)

애플리케이션 계층의 데이터가 전송 계층으로 전달되면서 `세그먼트` 또는 `데이터그램`화 되며 TCP 헤더 붙여진다

인터넷 계층으로 가면서 IP 헤더가 붙여지며 `패킷`화가 되고

링크 계층으로 전달되면서 프레임헤더와 프레임 트레일러가 붙어 `프레임`화가 되고

이와 같은 캡슐화 과정을 거쳐 전달되고 링크 계층을 통해 해당 서버와 통신하고 다시 애플리케이션 계층까지 전달되면서 반대로 비 캡슐화 과정을 거치게 된다.

### IPv4 vs IPv6

- IPv4 : 32비트 , 2^ 32개의 주소 8비트 단위로 점을 찍어 4개로 구분 (10진수)
- IPv6 : 128비트, 2^128개의 주소 16비트씩 8개로 구분, 각 단위는 16진수로 변환되어 콜론으로 구분하여 표기한다. 앞의 64비트는 네트워크 주소를 의미하며 뒤의 64비트는 네트워크에 연결된 통신장비 등에 할당되는 인터페이스 주소를 의미한다.

#### 발전된 점

확대된 주소 공간

단순해진 헤더 포맷 

간편해진 주소 설정기능

강화된 보안 기능