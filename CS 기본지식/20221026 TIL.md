## 데이터 베이스

일정한 규칙 혹은 규약을 통해 구조화 되어 저장되는 데이터 모음 입니다. 데이터베이스를 제어 관리하는 통합 시스템을 DBMS라고 하며 데이터 베이스 안에 있는 데이터 들은 특정 DBMS마다 정의된 쿼리 언어를 통해 삽입 삭제 수정 조회 등을 수행할 수 있습니다.

### 엔터티

사람, 장소, 물건 , 사건 ,개념 등 여러 개의 속성을 지닌 명사를 의미합니다.

회원이라는 엔터티가 있다면 이름, 주소, 아이디 와 같은 속성을 갖는다.

### 릴레이션

데이터베이스에서 정보를 구분하여 저장하는 기본 단위 입니다. 엔터티에 관한 데이터를 데이터베이스는 릴레이션 하나에 담아서 관리합니다.

관계형 데이터베이스에서는 테이블이라고 하며 NoSQL에서는 컬렉션이라 부릅니다.

관계형 데이터 베이스는 레코드->테이블->데이터베이스로 누적되며 레코드는 우리가 표로 치면 행으로 볼 수 있습니다.

NoSQL은 도큐먼트->컬렉션->데이터베이스로 누적됩니다.\

### 속성

릴레이션에서 관리하는 구체적이며 고유한 이름을 갖는 정보입니다.

차라는 엔터티는 바퀴 수 , 넘버, 색깔 등의 속성을 가집니다.

### 도메인

릴레이션에 포함된 각각의 속성들이 가질 수 있는 값의 집합입니다.

만약 성별이라는 속성이 있으면 `남 or 여`가 도메인이 됩니다.

### 필드와 레코드

우리가 흔히 아는 표로 설명을 하면 칼럼의 가장 위쪽에 속성의 이름들을 필드라고 하며

하나의 행을 레코드 혹은 튜플이라고 합니다.

### 필드 타입

필드들도 타입을 갖습니다. 

### 관계

데이터베이스에 테이블은 하나만 있는 것이 아닙니다, 여러 개의 테이블이 있고 이러한 테이블은 서로의 관계가 정의 되어 있습니다.

이러한 관계를 관계 화살표로 나타냅니다.

![image-20221026190213663](C:\Users\yhnb3\AppData\Roaming\Typora\typora-user-images\image-20221026190213663.png)

#### 1 : 1 관계

유저당 이메일은 한개이므로 1:1 관계입니다.

#### 1 : N 관계

한 유저당 여러개의 상품을 장바구니에 넣을 수 있습니다.

#### N : M관계

한 사람은 여러 개의 강의를 들을 수 있으며 한 강의는 여러 명이 들을 수 있습니다.

### 키

테이블 간의 관계를 조금 더 명확하게 하고 테이블 자체의 인덱스를 위해 설정된 장치로 기본키, 외래키, 후보키, 슈퍼키, 대체키가 있습니다.

- 슈퍼키 : 최소성
- 후보키 : 유일성, 최소성
- 기본키 : 후보키 중 하나
- 대체키 : 후보키 중 기본키를 제외한 키

#### 기본키

PK(primary key)라고들 많이하며 유일성과 최소성을 만족하는 키 입니다.

이는 테이블 중 고유하게 존재하는 속성입니다. 복합키로도 유일성을 만족할 수 있지만 이는 최소성에 위배됩니다.

- 자연키 : 중복되는 속성을 배제하다보니 자연스럽게 선택되는 키
- 인조키 : 중복되지 않게 하기 위해 만들어진 속성

#### 외래키

FK(foreign key)라고 하며 다른 테이블의 기본키를 그대로 참조하는 값으로 개체와의 관계를 식별하는데 사용합니다.

#### 후보키

기본키가 될 수 있는 후보키, 최소성과 유일성 모두 만족

#### 대체키

후보키가 두개 이상일 경우 어느 하나의 기본키로 지정하고 남은 후보키들을 말합니다.

#### 슈퍼키

각 레코드를 유일하게 식별할 수 있는 유일성을 갖춘 키입니다.

### ERD

ERD : Entity Relation Diagram 은 데이터 베이스를 구축할 때 가장 기초적인 뼈대 역할을 하며, 릴레이션 간의 관계를 정의한 것입니다.

ERD는 시스템 요구사항을 기반으로 작성 되며 이것을 바탕으로 데이터베이스를 구축합니다. 구축한 후에도 디버깅 또는 비지니스 프로세스 재설계가 필요한 경우에 설계도 역할을 담당하기도 합니다.

### 정규화 과정

릴레이션 간의 잘못된 종속 관계로 인해 데이터베이스 이상 현상이 일어나서 이를 해결하거나, 저장 공간을 효율적으로 사용하기 위해 릴레이션을 여러개로 분리하는 과정입니다.

이상현상

- 삭제 이상
- 삽입 이상

#### 정규형 원칙

같은 의미를 표한하는 릴레이션이지만 좀 더 좋은 구조로 만들어야 하고 자료의 중복성은 감소해야하고 독립적인 관계는 별개의 릴레이션으로 표현해야 하며, 각각의 릴레이션은 독립적인 표현이 가능해야 하는 것을 말합니다.

#### 제 1 정규형

릴레이션의 모든 도메인이 더 이상 분해할 수 없는 원자 값 만으로 존재해야합니다.

즉 값은 하나만 가져야 하며 여러개일 경우 여러 레코드로 표현해야합니다.

#### 제 2 정규형

부분 함수의 종속성을 제거한 형태를 말합니다.

기본키가 아닌 모든 속성이 기본키에 완전 함수 종속적인 것을 말합니다.

기본키가 아닌 속성에 종속적인 속성이 있다면 릴레이션을 나누어 주어야 합니다.

#### 제 3 정규형

기본키가 아닌 모든 속성이 이행적 함수 종속을 만족하지 않는 상태를 말합니다.

A -> B 그리고 B -> C  그래서 A -> C를 이행적 종속이라 말하며 이런 종속관계를 가지는 속성 A, B, C 가 있다면

(A, B) , (B, C)로 릴레이션을 나누어 주어야 합니다.

#### 보이스 코드 정규형

결정자가 후보키가 아닌 함수 종속 관계를 제거하여 릴레이션의 함수 종속 관계에서 모든 결정자가 후보키인 상태를 말합니다. 

## 트랜잭션과 무결성

### 트랜잭션

트랜잭션은 데이터베이스에서 하나의 논리적 기능을 수행하기 위한 작업의 단위를 말하며 데이터 베이스에 접근하는 방법은 쿼리 이므로 즉, 여러개의 쿼리를 하나로 묶는 단위입니다.

- 원자성 : 트랮잭션과 관련된 일이 모두 수행되거나 모두 수행되지 않거나를 보장한다.

- 일관성 : 허용된 방식으로만 데이터를 변경할 수 있어야 합니다.

- 격리성 : 트랜잭션 수행시 서로 끼어들지 못하는 것을 의미합니다.

  여러개의 격리 수준으로 나뉘어 격리성을 보장합니다.

  격리 수준

  - Serializable : 트랜잭션을 순차적으로 진행 동시에 진행하는 트랜잭션이 접근한 행에는 접근 불가
  - Repeatable_Read : 하나의 트랜잭션이 수정한 행을 다른 트랜잭션이 수정할 수 없도록 막아주지만 새로운 행을 추가되는것은 막지 않는다.
  - Read_commited : 가장 많이 사용되는 격리수준 커밋이 완료된 데이터에 대해서만 조회를 허용합니다.
  - Read_uncommited : 하나의 트랜잭션이 커밋되기 이전에 다른 트랜잭션에 노출될 수 있습니다.

- 지속성 : 성공적으로 이행된 트랜잭션은 영원히 반영되어야합니다.

### 무결성

데이터의 정확성, 일관성, 유효성을 유지하는것을 말하며 무결성이 유지되어야 데이터베이스에 저장된 값과 그 값에 해당하는 현실세계의 실제 값이 일치하는 지에 대한 신뢰가생깁니다.

## 데이터 베이스의 종류

### RDBMS

관계형 데이터베이스이며 행과 열을 가지는 표 형식으로 데이터를 저장합니다. SQL이라는 언어를 써서 조작합니다.

### NoSQL

SQL을 사용하지 않는 데이터 베이스 mongoDB, Redis

## 인덱스

### 필요성

인덱스는 데이터를 빠르게 찾을 수 있는 하나의 장치 입니다.

#### B-트리

어떤 값이 있으면 그 값이 있을법한 노드로 가서 탐색을 할 수 있는 트리입니다.

#### 인덱스가 효율적인 이유와 대수확장성

인덱스가 효율적인 이유는 효율적인 단계를 거쳐 모든 요소에 접근할 수 있는 균형적인 트리 구조와 트리 깊이의 대수확장성 때문입니다.

데이터의 수에 비해 트리의 깊이는 아주 느리게 성장하기 때문입니다.

### 인덱스 최적화 기법

1. 인덱스는 비용이다.

   인덱스는 2번 탐색하도록 강요합니다. 인덱스 리스트 그다음 컬렉션 순으로 탐색하기 때문에 관련 일기 비용이 들게 됩니다. 그리고 컬렉션이 수정되면 인덱스도 수정되어야 합니다. 

   그렇기 때문에 쿼리에 있는 필드에 인덱스를 무작정 다 설정하는 것은 답이 아닙니다. 컬렉션에서 가져와야할 데이터가 많을 수록 인덱스를 사용하는 것은 비효율적입니다.

2. 항상 테스팅하라

   인덱스를 만든 후에 항상 얼마나 좋아졌는지 테스팅하는 것이 중요합니다.

3.  복합 인덱스는 같음, 정렬, 다중 값, 카디널리티 순입니다.