## HTTP 개관

http 통신은 신뢰성 있는 데이터 전송 프로토콜을 사용하기 때문에, 데이터가 지구 반대편에서 오더라도 전송 중 손상되거나 꼬이지 않음을 보장한다.

### 웹 클라이언트와 서버

웹 콘텐츠는 웹 서버에 존재하며 웹서버는 http 프로토콜로 의사소통하기 때문에 http 서버라 불린다. 웹 클라이언트인 브라우저에서 웹 서버로 http 요청을 하면 웹 서버는 요청에 따른 응답을 던져주는 것이 일반적인 http 통신이다.

### 리소스

웹 서버는 다양한 웹 리소스들을 관리한다. 무조건적으로 정적 리소스 일 필요도 없고 동적 리소스 이기도 하다.

#### URI

클라이언트는 웹 서버에서 원하는 리소스를 요청할 수 잇고 서버 리소스의 이름은 통합 자원 식별자라 하여 uri로 통칭한다. 정보 리소스를 고유하게 식별하고 위치를 지정하는데 사용됩니다.

URI에는 URL과 URN 두 종류가 있습니다.

#### URL

통합 자원 지시자이며 리소스 식별의 가장 흔한 형태입니다. URL은 특정 서버의 한 리소스에 대해 구체적인 위치를 서술합니다. URL은 다음과 같은 표준 포맷을 따릅니다.

- 첫번째 부분은 스킴이라 불리며 리소스에 접근하기 위한 프로토콜을 서술합니다. 보통 HTTP 프로토콜을 사용합니다.
- 두번째 부분은 서버의 인터넷 주소를 제공합니다.
- 웹 서버의 리소스를 가리킵니다.

#### URN

유니폰 리소스 이름이며 콘텐츠를 이루는 한 리소스에 대해 그 리소스의 위치에 영향 받지 않는 유일무이한 이름 역할응 한다.

현재 적극적으로 사용되는 상태는 아니며 URI는 보통 URL로 통칭하여 사용할 정도로 사용성이 미비한 상태입니다.

### 트랜잭션

HTTP 트랜잭션은 요청 명령과 응답 명령으로 구성되어 있습니다. 이는 HTTP 메시지라는 정형화된 데이터 덩어리를 통해 이루어 집니다.

#### 메서드

GET, POST, PUT, PATCH, DELETE

#### 상태코드

200 : 문서가 제대로 반환

300 : 다시 보내라. 다른 곳에서 리소스를 찾아라

400 : 리소스 없다.

웹 서버에서 브라우저에 주는 메시지에 포함되어 있습니다.

### 메시지

메시지는 간단하게 3부분으로 이루어져있습니다.

- 시작줄

  요청이라면 무엇을 해야하는 응답이라면 무슨일이 일어 났는지에 대한 정보가 있습니다.

- 헤더

  0개 이상의 헤더가 필요하며 각 헤더 필드는 키와 밸류로 구성되어 있습니다. 헤더 필드를 추가하기 위해서는 그저 한줄만 더하면 되며 빈 줄로 끝이 납니다.

- 분문

  어떤 종류의 데이터도 들어갈 수 있습니다.

### TCP 커넥션

#### TCP/IP 

HTTP는 애플리케이션 계층 프로토콜입니다. HTTP는  TCP/IP에게 데이터 전송을 맡깁니다.

TCP는 오류없는 전송, 순서에 맞는 전달, 조각나지 않은 데이터 스트림을 보장합니다.

그럼 어떤식으로 TCP/IP 커넥션을 맺을 수 있을까요

1. 일단 IP 주소가 필요합니다.  
2. 도메인주소에서 호스트 명을 DNS서버로 IP로 변환 합니다.
3. 포트 번호를 추출합니다.
4. TCP 커넥션을 합니다. (3 way handshake)

### 프로토콜 버전

- 0.9 

  금방 1.0으로 대체 됨

- 1.0

  널리 쓰이기 시작한 버전이나 잘 만들어진 명세는 아니다.

- 1.0+ 

  keep-alive 커넥션 가상, 호스팅 지원, 프락시 연결 지원을 포함해 많은 기능이 추가되었습니다.

- 1.1

  구조적 결함 교정, 두드러진 성능 최적화, 잘못된 기능 제거에 집중했습니다.

- 2.0

  1.1 성능 문제를 개선하기 위해 spdy 프로토콜을 기반으로 설계가 진행 중인 프로토콜 입니다.

###  웹의 구성요소

- 프록시 : 클라이언트와 서버 사이의 중개자
- 캐시 : 많이 찾는 웹페이지를 클라이언트 가까이에 보관하는 HTTP 창고
- 게이트웨이 : 다른 애플리케인과 연결된 특별한 웹 서버
- 터널 : 단순히 HTTP 통신을 전달하기만 하는 특별한 프록시
- 에이전트 : HTTP 요청을 만드는 준 지능적 웹 클라이언트

#### 프록시

웹 보안, 애플리케이션 통합, 성능 최적화를 위한 중요한 요소이다.

클라이언트와 서버 사이에 위치하며 클라이언트의 HTTP 요청을 서버에 전달한다. 프록시는 주로 보안을 위해 사용된다. 특정 컨텐츠를 필터링할때 사용되기도 한다.

#### 캐시

자주 찾는 문서의 사본을 저장해 두는 특별한 종류의 HTTP 프록시 서버이다. 멀리 떨어진 웹서버보다 훨씬 가까이서 문서를 다운 받을 수 있습니다.

#### 게이트 웨이

다른 서버들의 중개자로 동작하는 특별한 서버다. 게이트 웨이는 주로 HTTP 트래픽을 다른 프로토콜로 변환하기 위해 사용된다. 게이트 웨이는 언제나 스스로가 리소스를 갖고 있는 진자 서버인 것처럼 요청을 다룬다.

#### 터널

두 커넥션 사이에서 데이터를 열어보지 않고 그대로 전달해주는 애플리케이션이다. HTTP 터널은 주로 비 HTTP 데이터를 하나 이상의 HTTP 연결을 통해 그대로 전송해주기 위해 사용된다.

HTTP 터널을 활용하는 대표적인 예로, 암호화된 SSL 트래픽을 HTTP 커넥션으로 전송함으로써 웹 트래픽만 허용하는 사내 방화벽을 통과시키는 것이 있다.



## 보충 공부

갑자기 궁금해진게 CSR과 같이 웹 서버에서 한번에 모든 파일을 받는 형식으로 구성되는 웹 페이지는 어떤식으로 라우팅을 하는걸까? url이 매번 바뀌지만 웹 서버로 부터 새로운 html을 받아오는 것은 아니다. 

CSR에서의 라우팅 즉, 우리가 흔히 사용하는 react-router에서의 라우팅은 해쉬를 이용한 라우팅이다. 해쉬는 리소스 경로가 아닌 웹 페이에서에서의 참조이기 때문에 리디렉션이 일어나지 않습니다.

그러니 CSR에서의 라우팅은 어떤 원리 일까

1. 해쉬를 사용하는 방법

   브라우저 url에서의 hash의 역할은 html 상의 어떠한 위치를 지정하는 용도로 사용이 됩니다. 그리고 dom api인 `hashchange`를 이용해서 해쉬의 변화를 인지하고 페이지를 리렌더링 할 수 있습니다. 하지만 해쉬는 검색 엔진이 인지 하지 못하기 때문에 서비스를 제공하는 입장에서는 단점을 가지게 될 수 밖에 없습니다.

2. history 라이브러리를 사용하는 방법

   리액트 라우터 라이브러리에서 사용하는 `history`라이브러리는 자바스크립트가 실행되는 모든 곳의  `history`를 관리할 수 있게 해줍니다. 그래서 우리가 정하는 `path`를 가지고 재귀적인 방법을 이용해 적절한 페이지를 렌더링 해 줄 수 있습니다.

추가 : 따로 webpack설정을 해주지 않은 react앱에서 router를 사용하는 중에 새로고침을 하면 제대로된 페이지가 보이지 않는 것도 서버는 존재하지 않는 공간에서 리소스를 요구하기 때문입니다. 그리고 설정을 통해 redirect 해줄 필요가 있습니다.
